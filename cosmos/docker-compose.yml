version: "2.3"
services:
    cosmos:
        build: .
        runtime: nvidia
        ipc: host
        volumes:
            - .:/vol/
            - ${INPUT_DIR}:/input/
            - ./output/:/output/ 
    redis:
      image: "redis:alpine"
      volumes:
        - ./redis_data:/data
      restart: always
      ports:
        - "6379:6379"
      command:
          redis-server --save "" --appendonly no

    cosmos_postgres:
        image: postgres:10.5-alpine
        environment:
            - POSTGRES_DB=cosmos
        volumes:
            - ./postgres-data:/var/lib/postgresql/data
        ports:
            - 54321:5432
    
